<!DOCTYPE html>
<html>

<head>
    <title>CommandsAndRecommendedFolderStructuresForTesting.md</title>
    <meta http-equiv="Content-type" content="text/html;charset=UTF-8">
    
<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

html,footer,header{
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Custom MD PDF CSS
 */
html,footer,header{
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";

 }
body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>
<link rel="stylesheet" href="file:///Users/snowball/Documents/Go/CheatSheet/R%3A%5C2.Travail%5C1.Enseignement%5CCours%5C_1.Outils%5C2.Developpement%5C1.SCSS%5Cmain.css" type="text/css"><link rel="stylesheet" href="file:///Users/snowball/Documents/Go/CheatSheet/D%3A%5Crdaros%5CCours%5C_1.Outils%5C2.Developpement%5C1.SCSS%5Cmain.css" type="text/css">
</head>

<body>
    <h1 id="go-language-testing-guide">Go Language Testing Guide</h1>
<p>This guide covers useful commands and recommended folder structures for testing in Go.</p>
<h2 id="1-go-test-commands">1. Go Test Commands</h2>
<p>The <code>go test</code> command is the primary tool for running tests in Go.</p>
<ul>
<li>
<p><strong>Run all tests in the current package:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span>
</div></code></pre>
<p>This command compiles and runs all <code>_test.go</code> files in the current directory's package.</p>
</li>
<li>
<p><strong>Run tests verbosely (show test names and results):</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -v
</div></code></pre>
<p>The <code>-v</code> flag provides more detailed output, including the name of each test function and its pass/fail status.</p>
</li>
<li>
<p><strong>Run tests matching a specific name/pattern:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -run YourTestName
go <span class="hljs-built_in">test</span> -run <span class="hljs-string">"TestSpecificFunction"</span>
go <span class="hljs-built_in">test</span> -run <span class="hljs-string">"Test_.*_Feature"</span> <span class="hljs-comment"># Run tests matching a regex pattern</span>
</div></code></pre>
<p>The <code>-run</code> flag takes a regular expression to filter which tests to run.</p>
</li>
<li>
<p><strong>Run tests and also run examples:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -run Example
</div></code></pre>
<p>Go's testing package supports example functions (prefixed with <code>Example</code>). These functions demonstrate how to use a package and are also run as tests to ensure their output remains correct.</p>
</li>
<li>
<p><strong>Run tests and skip caching:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -count=1
</div></code></pre>
<p>By default, <code>go test</code> caches successful test results. <code>-count=1</code> disables this cache, forcing tests to re-run. Useful when you suspect caching issues or need to ensure fresh execution.</p>
</li>
<li>
<p><strong>Run tests with code coverage analysis:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -cover
</div></code></pre>
<p>This flag enables code coverage analysis, showing the percentage of your code covered by tests.</p>
</li>
<li>
<p><strong>Run tests with code coverage and generate an HTML report:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -coverprofile=coverage.out
go tool cover -html=coverage.out
</div></code></pre>
<p>The <code>-coverprofile</code> flag writes the coverage data to a file (e.g., <code>coverage.out</code>). Then, <code>go tool cover -html</code> opens an HTML report in your browser, highlighting covered and uncovered lines.</p>
<h1 id="aliase">Aliase</h1>
<pre class="hljs"><code><div><span class="hljs-built_in">alias</span> gocover=<span class="hljs-string">'go test -coverprofile=coverage.out &amp;&amp; go tool cover -html=coverage.out -o coverage.html &amp;&amp; open coverage.html'</span>

<span class="hljs-comment"># Add this to your ~/.bashrc, ~/.zshrc, or shell configuration file</span>
<span class="hljs-comment"># Run source ~/.bashrc (or your config file) to load it</span>
<span class="hljs-comment"># Simply type gocover in your Go project directory</span>

</div></code></pre>
<p>Enhanced version (auto-cleanup):</p>
<pre class="hljs"><code><div><span class="hljs-built_in">alias</span> gocover=<span class="hljs-string">'go test -coverprofile=coverage.out &amp;&amp; go tool cover -html=coverage.out -o coverage.html &amp;&amp; open coverage.html &amp;&amp; rm coverage.out coverage.html'</span>

</div></code></pre>
<p>For Windows (<a href="./WindowsGocover.md">LINK</a>)</p>
</li>
<li>
<p><strong>Run tests with race detection:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -race
</div></code></pre>
<p>The <code>-race</code> flag enables the built-in data race detector, which helps find concurrency bugs. It can be resource-intensive but is crucial for concurrent applications.</p>
</li>
<li>
<p><strong>Run benchmarks:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -bench=.
</div></code></pre>
<p>The <code>-bench</code> flag runs benchmark functions (prefixed with <code>Benchmark</code>). The <code>.</code> runs all benchmarks.</p>
</li>
<li>
<p><strong>Run benchmarks matching a specific pattern:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -bench=<span class="hljs-string">"BenchmarkSpecificOperation"</span>
</div></code></pre>
</li>
<li>
<p><strong>Run benchmarks for a specific duration:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -bench=. -benchtime=5s
```benchtime` specifies the minimum time to run each benchmark.

</div></code></pre>
</li>
<li>
<p><strong>Run benchmarks for a specific number of iterations:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">test</span> -bench=. -benchtime=100x
</div></code></pre>
</li>
<li>
<p><strong>Show help for <code>go test</code>:</strong></p>
<pre class="hljs"><code><div>go <span class="hljs-built_in">help</span> <span class="hljs-built_in">test</span>
</div></code></pre>
</li>
</ul>
<h2 id="2-go-test-folder-structure">2. Go Test Folder Structure</h2>
<p>Go's testing philosophy encourages placing tests alongside the code they test.</p>
<h3 id="standard-package-testing">Standard Package Testing</h3>
<ul>
<li>
<p><strong>Tests in the same package:</strong><br>
By convention, test files (<code>_test.go</code>) are placed in the same directory as the source code they are testing. These tests belong to the same package as the source code (e.g., <code>package mypackage</code>). They have access to internal (unexported) functions and variables of the package.</p>
<pre class="hljs"><code><div>myproject/
├── mypackage/
│   ├── mypackage.go        // package mypackage
│   └── mypackage_test.go   // package mypackage
└── main.go
</div></code></pre>
<ul>
<li><strong>Pros:</strong> Direct access to unexported identifiers, easy to write unit tests.</li>
<li><strong>Cons:</strong> Can create tight coupling between test code and implementation details.</li>
</ul>
</li>
</ul>
<h3 id="external-package-testing-integrationblack-box-testing">External Package Testing (Integration/Black-Box Testing)</h3>
<ul>
<li>
<p><strong>Tests in a separate <code>_test</code> package:</strong><br>
For integration or black-box testing, you can place test files in the same directory but declare them as part of a separate package, typically named <code>packagename_test</code>. This means the test code can only access the exported (public) functions and types of the package.</p>
<pre class="hljs"><code><div>myproject/
├── mypackage/
│   ├── mypackage.go        // package mypackage
│   └── mypackage_test.go   // package mypackage_test
└── main.go
</div></code></pre>
<ul>
<li><strong>Pros:</strong> Tests only the public API, mimicking how external users would interact with your package. Promotes good API design.</li>
<li><strong>Cons:</strong> Cannot directly test unexported functions.</li>
</ul>
</li>
</ul>
<h3 id="dedicated-test-directory-less-common-but-useful-for-large-projectse2e">Dedicated <code>test</code> Directory (Less Common, but useful for large projects/e2e)</h3>
<p>While not the standard Go way, for larger projects or end-to-end (e2e) tests, some teams might opt for a dedicated <code>test</code> directory at the project root or within a module.</p>
<pre class="hljs"><code><div>myproject/
├── pkg/
│   └── mypackage/
│       └── mypackage.go
├── cmd/
│   └── myapp/
│       └── main.go
└── test/                 // Dedicated directory for integration/e2e tests
    ├── integration/
    │   └── myapp_integration_test.go
    └── e2e/
        └── myapp_e2e_test.go
</div></code></pre>
<ul>
<li><strong>Pros:</strong> Clear separation of concerns, especially for complex integration/e2e tests that might involve setting up external dependencies (databases, APIs).</li>
<li><strong>Cons:</strong> Not the idiomatic Go approach for unit tests; requires more explicit import paths. Can make it harder to directly test internal package logic.</li>
</ul>
<h3 id="mocks-and-test-data">Mocks and Test Data</h3>
<ul>
<li>
<p><strong>Co-locate mocks with tests:</strong><br>
If you use mocking frameworks or generate mock interfaces, it's common to place them alongside your <code>_test.go</code> files or in a <code>mocks/</code> subdirectory within the package.</p>
<pre class="hljs"><code><div>myproject/
├── mypackage/
│   ├── mypackage.go
│   ├── mypackage_test.go
│   └── mocks/
│       └── mock_interface.go // Generated mock
└── main.go
</div></code></pre>
</li>
<li>
<p><strong>Test data:</strong><br>
For test data (e.g., JSON files, CSVs), a <code>testdata/</code> subdirectory within the test package is a common pattern. <code>go test</code> ignores directories named <code>testdata</code>.</p>
<pre class="hljs"><code><div>myproject/
├── mypackage/
│   ├── mypackage.go
│   ├── mypackage_test.go
│   └── testdata/
│       └── sample.json
└── main.go
</div></code></pre>
</li>
</ul>
<h3 id="general-best-practices">General Best Practices</h3>
<ul>
<li><strong>Test one thing:</strong> Each test function should ideally focus on testing a single, specific aspect of your code.</li>
<li><strong>Keep tests fast:</strong> Fast tests encourage frequent execution. For slow tests, consider using <code>testing.Short()</code> or separate build tags.</li>
<li><strong>Avoid dependencies in unit tests:</strong> Unit tests should be isolated and not depend on external services (databases, network). Use mocks or fakes for dependencies.</li>
<li><strong>Use <code>t.Parallel()</code>:</strong> For tests that don't share state, use <code>t.Parallel()</code> to run them concurrently and speed up test execution.</li>
<li><strong>Comprehensive testing:</strong> Aim for good code coverage, but remember that coverage is a metric, not a goal in itself. Focus on testing critical paths and edge cases.</li>
</ul>

</body>

</html>